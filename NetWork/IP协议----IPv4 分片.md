## IP协议----IPv4 分片

### 为什么会进行数据包分片？

- 我们在IPv4协议报的首部中知道，一个IP数据报最长可以有65535字节。但是所有的数据包都会被传送到链路层进行进一步封装，而链路层的MTU（最大传送单元）是有限的，一般远小于65535字节，例如以太网的MTU大概是1500字节左右。
- 不仅如此，数据包在链路层中传输时，是经过多条不同的链路的，对于每一种链路其MTU大多不同，从一个MTU较高的链路转向一个MTU较低的链路，同样是需要进行分片操作。

### 标识 identification，标志 flags，片位移各有什么用？

- **identification**用于确定所分的片是同一个数据报。接受端在进行数据报重组时，通过identification来确定哪些数据片是属于同一个大的数据报的。
- **flags**用于确定最后一个数据片和其他数据片。最后一个数据片置0，其他置1.因为，接收端需要确定当前数据报是否已经接受完，还是后面还有其他数据片。flags用以判断何时结束。
- **offset**。用于标记数据片在数据报本身中的位置，初始offset为0，第二个offset为上一个数据片后的开始字节。

### 分片的缺点

- 使得路由器和端系统更为复杂。
- 能够被用于生成DoS攻击。

**注意**：IPv6协议中已经废止了分片。





