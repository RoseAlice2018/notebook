# 数据库原理

1. 为什么数据库加严格两阶段锁或强两阶段锁？
   1. 两阶段锁：保证可串行性是必要不充分的，不能避免死锁
      1. 增长阶段。事务可以获得锁，但是不能释放锁。
      2. 缩减阶段。事务可以释放锁，但是不能获得新锁。
   2. 严格两阶段锁：避免级联回滚导致的死锁 保证结果调度的可恢复性和无级联性
      1. 所有排他性锁都必须在事务提交后释放。
   3. 强两阶段锁：
      1. 事务提交前不得释放任何锁。
   
2. 为什么要在数据库中引入事务的概念？

   1. 在数据库使用者的角度，数据库中一组操作被视为一项操作，要么执行成功，要么一起执行失败。这样构成一组单一逻辑的操作集合被称为事务。

3. 为什么要在数据库中设置多种不同粒度的锁？

   1. 某些情况，把多个数据项聚为一组，将他们作为聚集数据项来处理，其效果可能更好。

4. 为什么要对数据库的调度进行可串行化判别，其实际意义是什么？
   1. 数据库的并发调度中，通过保证并发调度的效果与不进行并发调度而是串行调度的结果是一样的，这样就保证了数据库处于一致状态，这种调度就称为可串行化调度。
   2. 进行可串行化判别是为了保证数据库的并发调度不会影响到数据库状态的一致性。

5. 若对数据库进行BCNF范式的分解,从而导致没有保持依赖，在数据库设计中要如何解决？

6. 数据库中，实体的完整性是如何保证的？

7. 如何降低数据库中的数据的冗余度？

   1. 范式

8. 如何标识弱实体集？

   1. 弱实体集
      1. 一类实体集其本身的属性不足以形成主码，必须依赖其他实体集而存在。
   2. 弱实体集属性和依赖的强实体集的主码。

9. 在SQL语句中，如何表示除法？

10. 关系代数中，与等值连接相比，自然连接的缺点是什么？

    1. 虽然可以指定查询的结果包含哪些列，但不能人为地指定哪些列被匹配。

11. 数据库管理系统中DDL所能完成的操作包括哪些？

    1. create 创建表
    2. drop 删除表
    3. alter 修改表

12. 关系数据库设计中，至少应满足的规范化条件是什么？

    1. 1NF

13. 判断分解后的关系模式是否合理的两个重要标志

    1. 无损分解
    2. 保持依赖

14. 基于多表的视图，可以完成哪些操作，不能完成哪些操作？

    1. 可以查询，不能更新。

15. 实体间联系有？

    1. 一对一 多对多 一对多 多对一

16. 简述等值连接和自然连接的异同。

    1. **等值连接**当条件为“=”的连接为等值连接，是连接属性值相等的那些元组。其结果是连接的表的所有列，包括重复列
    2. **自然连接**自然连接不仅要求连接的两个字段必须同名，还要求将结果中重复的属性列去掉。
    3. 它们两个都是在笛卡尔乘积的情况下进行筛选。

17. 简述where子句和having子句的区别。

    1. 都是用于进行筛选，where对一般属性，having 对聚集属性列进行判断。

18. 简述两阶段锁的具体含义。

    1. 增长阶段：事务可以获得锁，但是不能释放锁。
    2. 缩减阶段：事务可以释放锁，但是不能获得新锁。

19. 简述数据库中为何要进行并发控制？

    1. 当多个事务在数据库中并发地执行时，数据的一致性可能不再维持，系统有必要控制各事务之间的相互作用。
       并发控制机制存在的目的是为了获得高度的并发性，同时保证所产生的调度是冲突可串行化的或视图可串行化可恢复的，并且无级联的。

20. 举例说明数据库中死锁含义及其解决方法。

    1. 事务之间相互等待对方所占用的资源。

       解决方法是两个死锁事务回滚其中的一个。

       解决方法主要有两种，一种是死锁预防，一种是允许系统进入死锁状态，然后试着用死锁检测与死锁恢复机制进行恢复。

21. **数据库中常用的完整性约束包括哪些？**

    1. not null
    2. unique
    3. check
    4. primary key
    5. foreign key

22. **简述数据库系统与文件系统的主要区别。**

    1. 这两个系统都包含了数据集合和一组程序。数据库协调数据的物理和逻辑访问，当文件系统只能协调物理访问。
    2. 数据库系统通过确保所有程序都可以使用一块物理数据来减少数据重复的数量。而在文件系统中的一个程序的数据在写的时候可能无法被另一个程序所读取。
    3. 数据库系统被设计允许对数据进行灵活的访问（即查询），当文件系统的设计目的是为了允许预先确定的访问（即编译程序）。
    4. 数据库管理系统被设计用来协调多用户管理相同的数据，文件处理系统通常被设计成允许一个或多个程序同时访问相同的数据。文件处理系统通常被设计成一个或多个程序同时访问不同的数据文件。在文件系统中，只有当两个程序对文件操作权限都是只读的时候才可以同时访问。

23. **一般情况下，关系R与关系S要进行自然连接，需要满足什么条件？**

    1. 至少有一个同名属性列。

24. **为什么要在数据库中引入事务的概念？**

25. **已知视图 faculty的定义：create view faculty as select id, name,dept name from
    instructor;当发布 insert into faculty values(130765’,‘Green,(Music’))命
    令时，数据库系统如何执行？**

    1. 这个插入必须被表示为对instructor的插入，这样必须给出salary的值，为此数据库有两种执行方案

       1.拒绝插入，并向用户返回一个错误信息。

       2.向instructor关系插入元组（‘130765’,‘Green,(Music’),null）

26. **用基本关系代数表达式来表示R\**∩ \cap∩\**S.**

    1. *R*∩*S*=*R*−(*R*−*S*)

27. **某银行为不同储蓄金额执行不同利率：低于10万元一年支付4.2%的利息，10万元以上（包括10万）一年支付4.5%的利息。假设储蓄账户表 account(aid（account_id）,balance, branch_name),写出与上述业务相对应的SQL语句，如何保证其执行结果的正确性？**

28. **什么样的关系模式满足BCNF?**

    1. 对于F + F^+*F*+的所有形如α → β \alpha\to\beta*α*→*β*的函数依赖（其中α ⊆ R , β ⊆ R \alpha\subseteq R,\beta\subseteq R*α*⊆*R*,*β*⊆*R*）,下面至少有一项成立。

       1.α → β \alpha\to\beta*α*→*β*是平凡的函数依赖

       2.α \alpha*α*是模式R R*R*的一个超码

29. **关系数据库中，超码、候选码、主码有什么区别？**

    1. 超码就一个或多个属性的集合，这些属性的组合可以在一个关系中唯一地标识一个元组。

       如果一个超码的任意真子集都不能称为一个超码，那它就是一个候选码，候选码是最小的超码。

       数据库设计者从候选码中任意选取一个码，叫做主码。

30. **关系代数中，选择操作的功能是什么？**

    1. 选择运算选出满足给定谓词的元组。

    2. 投影运算返回作为参数的关系，但把某些关系排除在外。

       集合差运算使得我们可以找出一个在一个关系中而不在另一个关系中的元组。

       笛卡尔积运算可以把任意两个关系组合起来。

31. **简述数据库中引入封锁机制的优缺点。**

    1. 优点：有效防止“丢失更新”，保证可重复读和不读“脏”数据

        缺点：产生了活锁，饿死和死锁的问题。

32. **数据库中，调度指的是什么？**

    1. 调度指的是指令在系统中执行的时间顺序，一组事务的一个调度一定包含了这组事务的所有指令，而且必须保持指令在各个事务中出现的时间顺序。

33. **事务由哪几个状态组成？判断当手机支付已提交，但由于网络信号消失而导致支付失败，此时，事务处于何种状态？**

    1. 由活动的、部分提交的、失败的、中止的、提交的

34. **数据库中如何判断死锁是否发生？**

    1. 死锁的检测需要维护一个资源等待图，周期性的激活一个在等待图中搜索环的算法，如果检测到了环的存在，那么判断死锁已经发生。

35. **什么样的调度一定能够保证数据的一致性？**

    1. 可串行化调度。

36. **为了保证数据库的并发性，引入了哪些锁？**

    1. 共享锁：事务T可读但不可写数据项Q

       排他锁：事务T可读又可写数据项Q

37. **为什么事务非正常结束时会影响数据库数据的正确性，请举例说明。**

